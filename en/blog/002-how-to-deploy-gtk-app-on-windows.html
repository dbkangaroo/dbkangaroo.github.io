<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How to deploy GTK based app on windows?(Updated at 08/03/2020) | Kangaroo</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/images/kangaroo.svg">
    <meta name="description" content="SQL client and admin tool for popular databases. focus on great experience and complete modeling, query, analysis, deployment, report, and automation quickly.">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="keywords" content="database,sql,dangaroo,kangaroodb,dbkangaroo,mysql,mariadb,sqlite,postgresql,redis,袋鼠,蓝色袋鼠,袋鼠数据库,数据库袋鼠,袋鼠数据库管理工具,袋鼠数据库工具,袋鼠数据库客户端">
    <link rel="preload" href="/assets/css/0.styles.c37742b7.css" as="style"><link rel="preload" href="/assets/js/app.827c9266.js" as="script"><link rel="preload" href="/assets/js/3.1365cd94.js" as="script"><link rel="preload" href="/assets/js/22.7a01a7ea.js" as="script"><link rel="prefetch" href="/assets/js/10.a1fb7ea6.js"><link rel="prefetch" href="/assets/js/100.ed89f054.js"><link rel="prefetch" href="/assets/js/101.82961209.js"><link rel="prefetch" href="/assets/js/102.bac2ac0c.js"><link rel="prefetch" href="/assets/js/103.cbafeb50.js"><link rel="prefetch" href="/assets/js/104.0597783b.js"><link rel="prefetch" href="/assets/js/105.6a8cb7e1.js"><link rel="prefetch" href="/assets/js/106.abcd3927.js"><link rel="prefetch" href="/assets/js/107.812f2faa.js"><link rel="prefetch" href="/assets/js/108.a0d2998b.js"><link rel="prefetch" href="/assets/js/109.61271b3c.js"><link rel="prefetch" href="/assets/js/11.73c80175.js"><link rel="prefetch" href="/assets/js/110.a4ef92e7.js"><link rel="prefetch" href="/assets/js/111.635c9fdf.js"><link rel="prefetch" href="/assets/js/112.3832540e.js"><link rel="prefetch" href="/assets/js/113.ca0787d4.js"><link rel="prefetch" href="/assets/js/114.c906f127.js"><link rel="prefetch" href="/assets/js/115.86888dcf.js"><link rel="prefetch" href="/assets/js/116.a1fd0c2d.js"><link rel="prefetch" href="/assets/js/117.32ac0fc9.js"><link rel="prefetch" href="/assets/js/118.59dc1d1f.js"><link rel="prefetch" href="/assets/js/119.31eeeb6b.js"><link rel="prefetch" href="/assets/js/12.56ab02a3.js"><link rel="prefetch" href="/assets/js/120.10fa91ae.js"><link rel="prefetch" href="/assets/js/121.27e77978.js"><link rel="prefetch" href="/assets/js/122.a831ed29.js"><link rel="prefetch" href="/assets/js/123.2da44d9d.js"><link rel="prefetch" href="/assets/js/124.c437f249.js"><link rel="prefetch" href="/assets/js/125.048b6502.js"><link rel="prefetch" href="/assets/js/126.0325f3f3.js"><link rel="prefetch" href="/assets/js/127.8060916e.js"><link rel="prefetch" href="/assets/js/128.d6926865.js"><link rel="prefetch" href="/assets/js/129.ba66d3b9.js"><link rel="prefetch" href="/assets/js/13.d5191aca.js"><link rel="prefetch" href="/assets/js/130.68f157c4.js"><link rel="prefetch" href="/assets/js/131.5a129b65.js"><link rel="prefetch" href="/assets/js/132.ee16384f.js"><link rel="prefetch" href="/assets/js/133.c159e2ce.js"><link rel="prefetch" href="/assets/js/134.cf5b0e7e.js"><link rel="prefetch" href="/assets/js/135.0e8036cc.js"><link rel="prefetch" href="/assets/js/136.c0e32247.js"><link rel="prefetch" href="/assets/js/137.f10d19c6.js"><link rel="prefetch" href="/assets/js/138.127ae575.js"><link rel="prefetch" href="/assets/js/139.2d5ad33d.js"><link rel="prefetch" href="/assets/js/14.986d2277.js"><link rel="prefetch" href="/assets/js/140.6aa6b9a2.js"><link rel="prefetch" href="/assets/js/141.759a93f5.js"><link rel="prefetch" href="/assets/js/142.b9d6dcea.js"><link rel="prefetch" href="/assets/js/143.af27dedb.js"><link rel="prefetch" href="/assets/js/144.fc01f8a3.js"><link rel="prefetch" href="/assets/js/145.7d479966.js"><link rel="prefetch" href="/assets/js/146.f35e59ba.js"><link rel="prefetch" href="/assets/js/147.e8a43721.js"><link rel="prefetch" href="/assets/js/148.e41c45a4.js"><link rel="prefetch" href="/assets/js/149.759b851a.js"><link rel="prefetch" href="/assets/js/15.fe06ad69.js"><link rel="prefetch" href="/assets/js/150.448b46e2.js"><link rel="prefetch" href="/assets/js/151.279d51df.js"><link rel="prefetch" href="/assets/js/152.f35acef5.js"><link rel="prefetch" href="/assets/js/16.05d7dc93.js"><link rel="prefetch" href="/assets/js/17.e0b934fc.js"><link rel="prefetch" href="/assets/js/18.ac498a79.js"><link rel="prefetch" href="/assets/js/19.0894395a.js"><link rel="prefetch" href="/assets/js/20.5e9b5824.js"><link rel="prefetch" href="/assets/js/21.8eb5bb9d.js"><link rel="prefetch" href="/assets/js/23.5e509776.js"><link rel="prefetch" href="/assets/js/24.749a32aa.js"><link rel="prefetch" href="/assets/js/25.e777827c.js"><link rel="prefetch" href="/assets/js/26.66614230.js"><link rel="prefetch" href="/assets/js/27.64774adf.js"><link rel="prefetch" href="/assets/js/28.f933f412.js"><link rel="prefetch" href="/assets/js/29.63d73c16.js"><link rel="prefetch" href="/assets/js/30.961af59d.js"><link rel="prefetch" href="/assets/js/31.28fee20f.js"><link rel="prefetch" href="/assets/js/32.a509f4c2.js"><link rel="prefetch" href="/assets/js/33.166dd8cf.js"><link rel="prefetch" href="/assets/js/34.c061c66e.js"><link rel="prefetch" href="/assets/js/35.be20ed54.js"><link rel="prefetch" href="/assets/js/36.9a52e9ab.js"><link rel="prefetch" href="/assets/js/37.c7dbe7f2.js"><link rel="prefetch" href="/assets/js/38.6f461a78.js"><link rel="prefetch" href="/assets/js/39.8a5e825f.js"><link rel="prefetch" href="/assets/js/4.c7431d4a.js"><link rel="prefetch" href="/assets/js/40.89dc1b80.js"><link rel="prefetch" href="/assets/js/41.51434c2c.js"><link rel="prefetch" href="/assets/js/42.b4820347.js"><link rel="prefetch" href="/assets/js/43.1b8a2047.js"><link rel="prefetch" href="/assets/js/44.f16f137b.js"><link rel="prefetch" href="/assets/js/45.4e5b582a.js"><link rel="prefetch" href="/assets/js/46.f79b2cac.js"><link rel="prefetch" href="/assets/js/47.c221168d.js"><link rel="prefetch" href="/assets/js/48.de842cd0.js"><link rel="prefetch" href="/assets/js/49.a9c9c4b0.js"><link rel="prefetch" href="/assets/js/5.41307945.js"><link rel="prefetch" href="/assets/js/50.bb2d6975.js"><link rel="prefetch" href="/assets/js/51.06b88553.js"><link rel="prefetch" href="/assets/js/52.481c3f55.js"><link rel="prefetch" href="/assets/js/53.975f5f6d.js"><link rel="prefetch" href="/assets/js/54.5ccf4b5a.js"><link rel="prefetch" href="/assets/js/55.d4b63b06.js"><link rel="prefetch" href="/assets/js/56.4dafe8ef.js"><link rel="prefetch" href="/assets/js/57.60544a1d.js"><link rel="prefetch" href="/assets/js/58.84a8c0ab.js"><link rel="prefetch" href="/assets/js/59.4a76b113.js"><link rel="prefetch" href="/assets/js/6.c701b7bd.js"><link rel="prefetch" href="/assets/js/60.5750ffee.js"><link rel="prefetch" href="/assets/js/61.5411c25e.js"><link rel="prefetch" href="/assets/js/62.d0e6cc0a.js"><link rel="prefetch" href="/assets/js/63.9729347c.js"><link rel="prefetch" href="/assets/js/64.d2380117.js"><link rel="prefetch" href="/assets/js/65.e8d8bf7a.js"><link rel="prefetch" href="/assets/js/66.0a0c619d.js"><link rel="prefetch" href="/assets/js/67.2864087f.js"><link rel="prefetch" href="/assets/js/68.b897b327.js"><link rel="prefetch" href="/assets/js/69.b59c203d.js"><link rel="prefetch" href="/assets/js/7.5eff0b79.js"><link rel="prefetch" href="/assets/js/70.d330eac6.js"><link rel="prefetch" href="/assets/js/71.f427eaa6.js"><link rel="prefetch" href="/assets/js/72.9c6eff0a.js"><link rel="prefetch" href="/assets/js/73.4b545a3c.js"><link rel="prefetch" href="/assets/js/74.0ce4f320.js"><link rel="prefetch" href="/assets/js/75.3fea7d73.js"><link rel="prefetch" href="/assets/js/76.2c09d952.js"><link rel="prefetch" href="/assets/js/77.16251e51.js"><link rel="prefetch" href="/assets/js/78.000fd3f7.js"><link rel="prefetch" href="/assets/js/79.58e8c69a.js"><link rel="prefetch" href="/assets/js/8.fea6edeb.js"><link rel="prefetch" href="/assets/js/80.a0b1afb9.js"><link rel="prefetch" href="/assets/js/81.d830cbca.js"><link rel="prefetch" href="/assets/js/82.c547ecfb.js"><link rel="prefetch" href="/assets/js/83.a2cafd18.js"><link rel="prefetch" href="/assets/js/84.52ea939d.js"><link rel="prefetch" href="/assets/js/85.4a38f6be.js"><link rel="prefetch" href="/assets/js/86.62271951.js"><link rel="prefetch" href="/assets/js/87.afc3d594.js"><link rel="prefetch" href="/assets/js/88.afc37b7d.js"><link rel="prefetch" href="/assets/js/89.43a1baf2.js"><link rel="prefetch" href="/assets/js/9.8e7f301e.js"><link rel="prefetch" href="/assets/js/90.36e3a877.js"><link rel="prefetch" href="/assets/js/91.b380f6c7.js"><link rel="prefetch" href="/assets/js/92.9b8d9daa.js"><link rel="prefetch" href="/assets/js/93.b75829f0.js"><link rel="prefetch" href="/assets/js/94.7f86fdaf.js"><link rel="prefetch" href="/assets/js/95.e0d44861.js"><link rel="prefetch" href="/assets/js/96.213094e6.js"><link rel="prefetch" href="/assets/js/97.347e8fdf.js"><link rel="prefetch" href="/assets/js/98.c455e774.js"><link rel="prefetch" href="/assets/js/99.f7007fe4.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.d85c5b54.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c37742b7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><img src="/images/kangaroo.svg" alt="Kangaroo" class="logo"> <span class="site-name can-hide">Kangaroo</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/document/feature-matrix.html" class="nav-link">
  Features
</a></div><div class="nav-item"><a href="/en/download/" class="nav-link">
  Download
</a></div><div class="nav-item"><a href="/en/license/license.html" class="nav-link">
  License
</a></div><div class="nav-item"><a href="/en/document/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/en/blog/" class="nav-link router-link-active">
  Blog
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  Default
</a></li><li class="dropdown-item"><!----> <a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/blog/002-how-to-deploy-gtk-app-on-windows.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/document/feature-matrix.html" class="nav-link">
  Features
</a></div><div class="nav-item"><a href="/en/download/" class="nav-link">
  Download
</a></div><div class="nav-item"><a href="/en/license/license.html" class="nav-link">
  License
</a></div><div class="nav-item"><a href="/en/document/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/en/blog/" class="nav-link router-link-active">
  Blog
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  Default
</a></li><li class="dropdown-item"><!----> <a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/blog/002-how-to-deploy-gtk-app-on-windows.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/en/blog/" aria-current="page" class="sidebar-link">Kangaroo's blog</a></li><li><a href="/en/blog/004-how-to-deploy-gtk-app-on-mac.html" class="sidebar-link">How to deploy GTK based app on Mac OS X?</a></li><li><a href="/en/blog/003-serialize-glib-object.html" class="sidebar-link">How to serialize / deserialize GLib object</a></li><li><a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html" aria-current="page" class="active sidebar-link">How to deploy GTK based app on windows?(Updated at 08/03/2020)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html#background" class="sidebar-link">Background</a></li><li class="sidebar-sub-header"><a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html#precondition" class="sidebar-link">Precondition</a></li><li class="sidebar-sub-header"><a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html#solution" class="sidebar-link">Solution</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html#prepare-app-directory-structure" class="sidebar-link">Prepare app directory structure</a></li><li class="sidebar-sub-header"><a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html#copy-dependent-libraries-of-app" class="sidebar-link">Copy dependent libraries of app</a></li><li class="sidebar-sub-header"><a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html#copy-app-resource-file" class="sidebar-link">Copy app resource file</a></li><li class="sidebar-sub-header"><a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html#compare-the-runtime-dependency-view" class="sidebar-link">Compare the runtime dependency view</a></li><li class="sidebar-sub-header"><a href="/en/blog/002-how-to-deploy-gtk-app-on-windows.html#full-source-code" class="sidebar-link">Full source code</a></li></ul></li></ul></li><li><a href="/en/blog/001-why-choose-vala.html" class="sidebar-link">Why choose Vala to build Kangaroo?</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="how-to-deploy-gtk-based-app-on-windows-updated-at-08-03-2020"><a href="#how-to-deploy-gtk-based-app-on-windows-updated-at-08-03-2020" class="header-anchor">#</a> How to deploy GTK based app on windows?(Updated at 08/03/2020)</h1> <h2 id="background"><a href="#background" class="header-anchor">#</a> Background</h2> <p>Since developing SQL client tool Kangaroo, I met the major trouble is how to deploy Kangaroo app to user, then searched all of solutions from internet, finally, I found a great article <a href="http://www.tarnyko.net/repo/gtk3_build_system/tutorial/gtk3_tutorial.htm" target="_blank" rel="noopener noreferrer">GTK+3 Installation Tutorial for Windows<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, it provides clear guide to deploy GTK based app, so the honor belongs to the author of article.</p> <h2 id="precondition"><a href="#precondition" class="header-anchor">#</a> Precondition</h2> <p>The app must be compiled and executed in environment: <a href="https://www.msys2.org/" target="_blank" rel="noopener noreferrer">MSYS2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="solution"><a href="#solution" class="header-anchor">#</a> Solution</h2> <h3 id="prepare-app-directory-structure"><a href="#prepare-app-directory-structure" class="header-anchor">#</a> Prepare app directory structure</h3> <p>To deploy GTK based app, the app must follow the directory structure like linux:</p> <div class="language- extra-class"><pre class="language-text"><code>[App Home]
    ├─bin
    ├─etc
    │  └─gtk-3.0
    ├─lib
    └─share
        ├─doc
        ├─glib-2.0
        │  └─schemas
        ├─icons
        │  ├─Adwaita
        │  └─hicolor
        ├─locale
        └─themes
            ├─Default
            ├─MS-Windows
            └─Windows10
</code></pre></div><div><div style="display:none;"></div> <ins data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3975819313740938" data-ad-slot="6760827895" class="adsbygoogle" style="display:block;text-align:center;"></ins> <div style="display:none;">
        (adsbygoogle = window.adsbygoogle || []).push({});
    </div></div> <h3 id="copy-dependent-libraries-of-app"><a href="#copy-dependent-libraries-of-app" class="header-anchor">#</a> Copy dependent libraries of app</h3> <p><strong>List of GTK dependencies</strong>
GTK depends on several libraries:</p> <ul><li>GLib</li> <li>cairo</li> <li>Pango</li> <li>ATK</li> <li>gdk-pixbuf</li></ul> <p>To run GTK programs you will also need:</p> <ul><li>gettext-runtime</li> <li>fontconfig</li> <li>freetype</li> <li>expat</li> <li>libpng</li> <li>zlib</li></ul> <p><strong>How to get the file list and copy them to target dir?</strong></p> <p>the solution is a series of linux commands combination like this:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ldd <span class="token string">&quot;<span class="token variable">${SOURCEDIR}</span>/build/src/kangaroo.exe&quot;</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'\/mingw64\/bin\/.*dll'</span> -o <span class="token operator">|</span> <span class="token function">xargs</span> -I<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token function">cp</span> -f <span class="token string">&quot;{}&quot;</span> <span class="token string">&quot;<span class="token variable">${TARGETDIR}</span>/bin/&quot;</span>
</code></pre></div><p><strong>Done the commands above is all right?   No!!!</strong></p> <p>Some components in the GTK framework have plugins like gdk-pixbuf / libgda, so we must use the commands to copy them one by one.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ldd /mingw64/bin/libpq.dll <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'\/mingw64\/bin\/.*dll'</span> -o <span class="token operator">|</span> <span class="token function">xargs</span> -I<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token function">cp</span> -f <span class="token string">&quot;{}&quot;</span> <span class="token string">&quot;<span class="token variable">${TARGETDIR}</span>/bin/&quot;</span>
</code></pre></div><h3 id="copy-app-resource-file"><a href="#copy-app-resource-file" class="header-anchor">#</a> Copy app resource file</h3> <ul><li><p>/etc</p> <ul><li>/gtk-3.0/settings.ini : applications-wide settings.</li> <li>*: miscellaneous files.</li></ul></li> <li><p>/lib</p> <ul><li>/gdk-pixbuf-2.0 : GDK-Pixbuf modules. SVG support.</li> <li>/gtk-3.0 : GTK+-IM modules.</li> <li>/pango : Pango modules.</li> <li>*: import libraries, headers, pkg-config files... only needed for development.</li></ul></li> <li><p>/share</p> <ul><li>/doc : license and copyleft.</li> <li>/gtk-3.0 : resource files for gtk3-demo program.</li> <li>/gtk-doc : documentation in HTML format.</li> <li>/icons : icon themes, used by gtk3-demo and gtk3-widget-factory.</li> <li>/locale : localization files. Internationalized text support.</li> <li>/themes : graphical themes.</li> <li>*: miscellaneous files.</li></ul></li></ul> <h3 id="compare-the-runtime-dependency-view"><a href="#compare-the-runtime-dependency-view" class="header-anchor">#</a> Compare the runtime dependency view</h3> <p>Execute the app under user environment and the app under dev environment in full function mode, compare the runtime dependency view, check the count of dll file and dll file name. make sure they are the same.</p> <p>Runtime dependency dll view tool <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer" target="_blank" rel="noopener noreferrer">Process Explorer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div><ins data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3975819313740938" data-ad-slot="6760827895" class="adsbygoogle" style="display:block;text-align:center;"></ins> <div style="display:none;">
        (adsbygoogle = window.adsbygoogle || []).push({});
    </div></div> <h3 id="full-source-code"><a href="#full-source-code" class="header-anchor">#</a> Full source code</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env sh</span>
<span class="token comment">#</span>
<span class="token comment"># Copyright(C) 2018-2020 taozuhong(https://github.com/taozuhong)</span>
<span class="token comment"># Important:</span>
<span class="token comment">#   These functions are a part of the Kangaroo tool suite;</span>
<span class="token comment">#   copyright taozuhong. 2018-2020.  All rights reserved.</span>
<span class="token comment">#</span>
<span class="token comment"># Author:    taozuhong</span>
<span class="token comment"># Created:   1.8.2019</span>
<span class="token comment">#</span>
<span class="token assign-left variable">SOURCEDIR</span><span class="token operator">=</span><span class="token string">&quot;$( cd &quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">dirname</span> <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span><span class="token variable">)</span></span>/../&quot;</span> <span class="token punctuation">;</span> <span class="token builtin class-name">pwd</span> -P <span class="token punctuation">)</span><span class="token string">&quot;
TARGETDIR=&quot;</span><span class="token variable">${SOURCEDIR}</span>/build/windows<span class="token string">&quot;
VERSION=&quot;</span><span class="token number">0.7</span>.2.<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%y%m%d<span class="token variable">)</span></span><span class="token string">&quot;
# check target directory exist and make it
echo -n &quot;</span>Check and <span class="token function">make</span> target directory<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token string">&quot;
if [ ! -d &quot;</span><span class="token variable">$TARGETDIR</span><span class="token string">&quot; ]; then
  mkdir <span class="token variable">$TARGETDIR</span>
  mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
  mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/lib/<span class="token string">&quot;
  mkdir -p &quot;</span><span class="token variable">${TARGETDIR}</span>/share/glib-2.0/schemas<span class="token string">&quot;
  mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/share/doc<span class="token string">&quot;
  mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/share/themes<span class="token string">&quot;
  mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/etc/<span class="token string">&quot;
else 
  if [ ! -d &quot;</span><span class="token variable">${TARGETDIR}</span>/bin<span class="token string">&quot; ]; then
    mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
  fi
  if [ ! -d &quot;</span><span class="token variable">${TARGETDIR}</span>/lib<span class="token string">&quot; ]; then
    mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/lib/<span class="token string">&quot;
  fi
  if [ ! -d &quot;</span><span class="token variable">${TARGETDIR}</span>/share<span class="token string">&quot; ]; then
    mkdir -p &quot;</span><span class="token variable">${TARGETDIR}</span>/share/glib-2.0/schemas<span class="token string">&quot;
    mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/share/<span class="token string">&quot;
    mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/share/doc<span class="token string">&quot;
    mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/share/themes<span class="token string">&quot;
  fi
  if [ ! -d &quot;</span><span class="token variable">${TARGETDIR}</span>/etc<span class="token string">&quot; ]; then
    mkdir &quot;</span><span class="token variable">${TARGETDIR}</span>/etc/<span class="token string">&quot;
  fi
fi
echo &quot;</span><span class="token punctuation">[</span>done<span class="token punctuation">]</span><span class="token string">&quot;
# copy app dependency library to target dir
echo -n &quot;</span>Copy app dependency library<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token string">&quot;
ldd &quot;</span><span class="token variable">${SOURCEDIR}</span>/build/src/kangaroo.exe<span class="token string">&quot; | grep &quot;</span><span class="token variable">$MSYSTEM_PREFIX</span><span class="token punctuation">\</span>/bin<span class="token punctuation">\</span>/.*dll<span class="token string">&quot; -o | xargs -I{} cp -f &quot;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
ldd <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libjson-glib-1.0-0.dll | grep &quot;</span><span class="token variable">$MSYSTEM_PREFIX</span><span class="token punctuation">\</span>/bin<span class="token punctuation">\</span>/.*dll<span class="token string">&quot; -o | xargs -I{} cp -f &quot;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
ldd <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libsoup-2.4-1.dll | grep &quot;</span><span class="token variable">$MSYSTEM_PREFIX</span><span class="token punctuation">\</span>/bin<span class="token punctuation">\</span>/.*dll<span class="token string">&quot; -o | xargs -I{} cp -f &quot;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
ldd <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libgtksourceview-4-0.dll | grep &quot;</span><span class="token variable">$MSYSTEM_PREFIX</span><span class="token punctuation">\</span>/bin<span class="token punctuation">\</span>/.*dll<span class="token string">&quot; -o | xargs -I{} cp -f &quot;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f &quot;</span><span class="token variable">${SOURCEDIR}</span>/build/src/kangaroo.exe<span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f &quot;</span><span class="token variable">${SOURCEDIR}</span>/data/assets/kangaroo.ico<span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/librsvg-2-2.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libgthread-2.0-0.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libcroco-0.6-3.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libtasn1-6.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libproxy-1.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libp11-kit-0.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libnettle-7.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libhogweed-5.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libgnutls-30.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libgmp-10.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
echo &quot;</span><span class="token punctuation">[</span>done<span class="token punctuation">]</span><span class="token string">&quot;
# copy GDBus/Helper and dependencies files
echo -n &quot;</span>Copy GDBus/Helper and dependencies<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/gdbus.exe &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
ldd <span class="token variable">$MSYSTEM_PREFIX</span>/bin/gdbus.exe | grep &quot;</span><span class="token variable">$MSYSTEM_PREFIX</span><span class="token punctuation">\</span>/bin<span class="token punctuation">\</span>/.*dll<span class="token string">&quot; -o | xargs -I{} cp -f &quot;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/gspawn-win64-helper.exe &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
ldd <span class="token variable">$MSYSTEM_PREFIX</span>/bin/gspawn-win64-helper.exe | grep &quot;</span><span class="token variable">$MSYSTEM_PREFIX</span><span class="token punctuation">\</span>/bin<span class="token punctuation">\</span>/.*dll<span class="token string">&quot; -o | xargs -I{} cp -f &quot;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
echo &quot;</span><span class="token punctuation">[</span>done<span class="token punctuation">]</span><span class="token string">&quot;
# libgda providers required library(MySQL/PostgreSQL/JDBC/...)
echo -n &quot;</span>Copy database client library <span class="token keyword">for</span> libgda<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libpq.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/bin/mariadb.dll &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
ldd <span class="token variable">$MSYSTEM_PREFIX</span>/bin/libpq.dll | grep &quot;</span><span class="token variable">$MSYSTEM_PREFIX</span><span class="token punctuation">\</span>/bin<span class="token punctuation">\</span>/.*dll<span class="token string">&quot; -o | xargs -I{} cp -f &quot;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
ldd <span class="token variable">$MSYSTEM_PREFIX</span>/bin/mariadb.dll | grep &quot;</span><span class="token variable">$MSYSTEM_PREFIX</span><span class="token punctuation">\</span>/bin<span class="token punctuation">\</span>/.*dll<span class="token string">&quot; -o | xargs -I{} cp -f &quot;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/bin/<span class="token string">&quot;
if [ -d &quot;</span><span class="token variable">${SOURCEDIR}</span>/libs/plugin<span class="token string">&quot; ]; then
  cp -rf &quot;</span><span class="token variable">${SOURCEDIR}</span>/libs/plugin<span class="token string">&quot; &quot;</span><span class="token variable">${TARGETDIR}</span>/lib<span class="token string">&quot;
fi
echo &quot;</span><span class="token punctuation">[</span>done<span class="token punctuation">]</span><span class="token string">&quot;
# copy GTK runtime dependencies resource
echo -n &quot;</span>Copy GTK runtime resource<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token string">&quot;
cp -rf <span class="token variable">$MSYSTEM_PREFIX</span>/lib/gdk-pixbuf-2.0 &quot;</span><span class="token variable">${TARGETDIR}</span>/lib/<span class="token string">&quot;
cp -rf <span class="token variable">$MSYSTEM_PREFIX</span>/lib/libgda-5.0 &quot;</span><span class="token variable">${TARGETDIR}</span>/lib/<span class="token string">&quot;
cp -rf <span class="token variable">$MSYSTEM_PREFIX</span>/lib/gio &quot;</span><span class="token variable">${TARGETDIR}</span>/lib/<span class="token string">&quot;
cp -rf <span class="token variable">$MSYSTEM_PREFIX</span>/etc/gtk-3.0 &quot;</span><span class="token variable">${TARGETDIR}</span>/etc/<span class="token string">&quot;
cp -rf <span class="token variable">$MSYSTEM_PREFIX</span>/share/icons &quot;</span><span class="token variable">${TARGETDIR}</span>/share/<span class="token string">&quot;
cp -rf <span class="token variable">$MSYSTEM_PREFIX</span>/share/locale &quot;</span><span class="token variable">${TARGETDIR}</span>/share/<span class="token string">&quot;
cp -rf <span class="token variable">$MSYSTEM_PREFIX</span>/share/gtksourceview-4 &quot;</span><span class="token variable">${TARGETDIR}</span>/share/<span class="token string">&quot;
glib-compile-schemas <span class="token variable">$MSYSTEM_PREFIX</span>/share/glib-2.0/schemas
cp -f <span class="token variable">$MSYSTEM_PREFIX</span>/share/glib-2.0/schemas/gschema* &quot;</span><span class="token variable">${TARGETDIR}</span>/share/glib-2.0/schemas<span class="token string">&quot;
cp -rf <span class="token variable">$MSYSTEM_PREFIX</span>/share/themes/Default &quot;</span><span class="token variable">${TARGETDIR}</span>/share/themes/<span class="token string">&quot;
cp -rf <span class="token variable">$MSYSTEM_PREFIX</span>/share/themes/MS-Windows &quot;</span><span class="token variable">${TARGETDIR}</span>/share/themes/<span class="token string">&quot;
find &quot;</span><span class="token variable">${TARGETDIR}</span>/lib<span class="token string">&quot; -type f -path '*.dll.a' -exec rm '{}' \;
echo &quot;</span><span class="token punctuation">[</span>done<span class="token punctuation">]</span><span class="token string">&quot;
# download license file: LGPL-3.0
echo -n &quot;</span>Downloading the remote license file<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token string">&quot;
if [ ! -f &quot;</span><span class="token variable">${TARGETDIR}</span>/share/doc/lgpl-3.0.txt<span class="token string">&quot; ]; then
  curl &quot;</span>https://www.gnu.org/licenses/lgpl-3.0.txt<span class="token string">&quot; -o &quot;</span><span class="token variable">${TARGETDIR}</span>/share/doc/lgpl-3.0.txt<span class="token string">&quot;
fi
if [ -f &quot;</span><span class="token variable">${TARGETDIR}</span>/share/doc/lgpl-3.0.txt<span class="token string">&quot; ]; then
  echo &quot;</span><span class="token punctuation">[</span>done<span class="token punctuation">]</span><span class="token string">&quot;
else
  echo &quot;</span><span class="token punctuation">[</span>failed<span class="token punctuation">]</span>&quot;
<span class="token keyword">fi</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dbkangaroo/dbkangaroo.github.io/edit/dev/en/blog/002-how-to-deploy-gtk-app-on-windows.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2020-11-18T12:42:53.000Z</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/en/blog/003-serialize-glib-object.html" class="prev">
        How to serialize / deserialize GLib object
      </a></span> <span class="next"><a href="/en/blog/001-why-choose-vala.html">
        Why choose Vala to build Kangaroo?
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.827c9266.js" defer></script><script src="/assets/js/3.1365cd94.js" defer></script><script src="/assets/js/22.7a01a7ea.js" defer></script>
  </body>
</html>
